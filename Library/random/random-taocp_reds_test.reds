Red/System []
#include %random-taocp.reds

print ["--- Testprogram for random-taocp.reds ---" lf]
print ["------test 1------" lf]
print ["2009 loops of 1009, seeded with 310952, expected result 995235265" lf]

random-taocp/ran_start 310952

i: 0
while [i <= 2009][
    random-taocp/ran_array random-taocp/ra 1009
    i: i + 1
]
print random-taocp/ra/1 print newline ;; value result 995235265

print ["------test 2------" lf]
print ["1009 loops of 2009, seeded with 310952, expected result 995235265" lf]

random-taocp/ran_start 310952

i: 0
while [i <= 1009][
    random-taocp/ran_array random-taocp/ra 2009
    i: i + 1
]
print random-taocp/ra/1 print newline ;; value result 995235265

print ["------test 3------" lf]
print ["print first 100 numbers from this array, seeded with 310952" lf]
comment { Expected result:
995235265 | 433642999 | 602969191 | 736656101 | 555599330 | 442403857 | 687544775 | 292798439 | 771808726 | 1058771320 
785806949 | 589827870 | 705688531 | 239491952 | 327612480 | 894395929 | 1044409615 | 484004117 | 801894636 | 617902035 
523057875 | 216925208 | 975471475 | 827619944 | 92749914 | 516839475 | 450711269 | 1050798086 | 488050497 | 906594531 
991740899 | 894122588 | 828822725 | 825015386 | 980123548 | 662258639 | 1543155 | 425406729 | 182312029 | 348102516 
605574948 | 516844431 | 726180254 | 829626304 | 828005450 | 893133408 | 515810265 | 415579904 | 1040666842 | 415884477 
247366975 | 4389279 | 217155570 | 348756118 | 42368980 | 148028800 | 376138291 | 225855023 | 405214555 | 560928291 
635392857 | 541759630 | 1030376981 | 215669361 | 531551824 | 252159121 | 206091177 | 759133011 | 631290110 | 113356350 
327734624 | 422454839 | 244337302 | 598646518 | 341974139 | 30781217 | 393890226 | 662351589 | 290538140 | 763011522 
787684894 | 70937286 | 349223335 | 703893082 | 966061300 | 84280221 | 767846100 | 18672959 | 468100465 | 907256650 
967996218 | 1055722073 | 1050915119 | 456806348 | 977878109 | 715868544 | 454555535 | 1042906986 | 353738986 | 758247705 }

i: 1
while [i < 101][
    print random-taocp/ra/i ;print " and buf: "
    ;print random-taocp/ran_arr_buf/i 
    either 0 = (i % 10) [print newline][print " | "]
    i: i + 1
]

print ["------test 4------" lf]
print ["print first 111 numbers using ran_arr_next function, seeded with 310952" lf]
comment { Expected result:
708622036 | 1005450560 | 806211866 | 246092984 | 999008239 | 168195638 | 584245821 | 393160299 | 855317023 | 25945628
733341343 | 1049097357 | 503034009 | 1032062593 | 125316172 | 119712622 | 708941582 | 295341606 | 359125556 | 912819704
724218942 | 510683750 | 316234679 | 691338672 | 812896238 | 927699543 | 550583157 | 509021883 | 931507327 | 986429610
463439063 | 974462551 | 486068214 | 24994686 | 636534944 | 60045063 | 579708650 | 366192827 | 512999189 | 232174415
515340970 | 813971027 | 395144818 | 262032475 | 660747223 | 670963240 | 430449501 | 227467403 | 641859505 | 532251337
348144155 | 1021668123 | 979103858 | 762240199 | 491819075 | 1026920728 | 220620851 | 678526373 | 546329460 | 1073051099
733069866 | 839393859 | 285532720 | 135131234 | 903311031 | 26893431 | 47880494 | 938776872 | 776676479 | 108755955
589380528 | 859907374 | 178470425 | 150218126 | 746523960 | 115288322 | 422361851 | 28500891 | 980442790 | 600802835
1041594945 | 92174897 | 828192812 | 28403686 | 479806542 | 530631427 | 357628137 | 206134481 | 268197941 | 755066740
490230986 | 935565817 | 805391331 | 616215443 | 515849916 | 960552961 | 617516454 | 769060776 | 550596651 | 395155840
53128703 | 904188671 | 227370300 | 585767292 | 494889597 | 450075644 | 375052251 | 415966041 | 677691533 | 221852561
913467932 }

random-taocp/ran_start 310952

i: 1
while [i < 112][
    print random-taocp/ran_arr_next 
    ;print random-taocp/ran_arr_buf/i 
    either 0 = (i % 10) [print newline][print " | "]
    i: i + 1
]

random-taocp/ran_arr_free

print newline
print ["--- Testprogram for random-taocp.reds end ---" lf]